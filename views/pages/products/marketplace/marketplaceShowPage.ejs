<% layout('layouts/boilerplate') %>
    <div class="container">
        <div class="container-fluid">
            <div class="row justify-content-center mt-3 mb-5">
                <div class="col-12 col-md-10">
                    <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-12 col-lg-5 mb-4 mb-lg-0">
                                    <div id="carouselExampleControls" class="carousel slide" data-bs-ride="carousel">
                                        <div class="carousel-inner">
                                            <% listing.marketplaceImage.forEach((img, i)=> { %> <div
                                                    class="carousel-item <%= i === 0 ? 'active' : '' %> productShow-item">
                                                    <img src="<%= img.url %>" class="d-block w-100 c-img" alt="...">
                                                </div>
                                                <% }); %>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-lg-6 ms-lg-4">
                                    <h3 class="mt-0">
                                        <%= listing.name %>
                                            <a href="javascript: void(0);" class="text-muted">
                                                <i class="mdi mdi-square-edit-outline ms-2"></i>
                                            </a>
                                    </h3>
                                    <div class="mt-3">
                                        <h5><span>Reviews</span></h5>
                                        <h3 class="mt-1" data-star="<%= overallReview %>"></h3>
                                        <div class="mt-4">
                                            <h6 class="font-14">Price:</h6>
                                            <h3>Â£<%= listing.price %>.99</h3>
                                        </div>
                                        <!-- Quantity -->
                                        <div class="mt-4">
                                            <% if (!signedInUser || signedInUser.username !==listing.username) { %>
                                                <h6 class="font-14">Quantity</h6>
                                                <div class="d-flex">
                                                    <form action="/basket" method="POST">
                                                        <div class="d-flex">
                                                            <input type="number" name="scrollQTY" min="1" value="1"
                                                                class="form-control" placeholder="Qty"
                                                                style="width: 90px;">
                                                            <input type="hidden" name="productId"
                                                                value="<%= listing._id %>">
                                                            <input type="hidden" name="name"
                                                                value="<%= listing.name %>">
                                                            <input type="hidden" name="price"
                                                                value="<%= listing.price %>">
                                                            <input type="hidden" name="quantity"
                                                                value="<%= listing.quantity %>">
                                                            <input type="hidden" name="image"
                                                                value="<%= listing.image %>">
                                                            <input type="hidden" name="description"
                                                                value="<%= listing.description %>">
                                                            <input type="hidden" name="category"
                                                                value="<%= listing.category %>">
                                                            <button type="submit" class="btn btn-primary ms-2">Add to
                                                                Basket</button>
                                                        </div>
                                                    </form>
                                                </div>
                                                <% } else if (signedInUser.username===listing.username) { %>
                                                    <form action="/marketplace/listings/<%= id %>?_method=DELETE"
                                                        method="POST">
                                                        <a href="/marketplace/listings/<%= id %>/edit"
                                                            class="btn btn-success my-3">Edit</a>
                                                        <button type="submit" class="btn btn-danger">Delete</button>
                                                    </form>
                                                    <% } %>
                                        </div>
                                        <!-- Listing description -->
                                        <div class="mt-4">
                                            <h6 class="font-14">Description:</h6>
                                            <p>Introducing our new listing, designed to enhance your daily life in a
                                                multitude of ways. Our listing is crafted with the highest quality
                                                materials and innovative technology, ensuring durability and reliability
                                                for years to come.</p>
                                        </div>
                                    </div>
                                </div>
                            </div> <!-- end row -->
                        </div> <!-- end card-body -->
                        <%- include('../../../partials/marketplaceReviews') %>
                    </div> <!-- end card -->
                </div> <!-- end col -->
            </div> <!-- end row -->
        </div> <!-- end container-fluid -->
    </div> <!-- end container -->